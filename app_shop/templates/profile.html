{% extends "base.html" %}
{% load static %}

{% block header %}
    {% include "header.html" %}
    <link rel="stylesheet" href="{% static 'css/profile.css' %}?v=8"/>
    {% if messages %}
    <ul class="messages">
    {% for message in messages %}
        <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
    {% endfor %}
    </ul>
    {% endif %}
{% endblock header %}

{% block body %}

<div class="cart-total-tag">
    <span>نام:</span>
    <span>{{ user.first_name }}</span>
</div>

<div class="cart-total-tag">
    <span>نام خانوادگی:</span>
    <span class="total-amount">{{ user.last_name }}</span>
</div>

<div class="cart-total-tag">
    <span>شماره تلفن:</span>
    <span class="total-amount">{{ user.phone_number }}</span>
</div>

<div class="cart-total-tag">
    <span>آدرس:</span>
    <span class="total-amount" id="address-display">{{ user.adress }}</span>
    <button id="edit-address-btn" class="btn btn-sm btn-primary">ویرایش آدرس</button>
</div>


<div id="edit-address-form" style="display:none; margin-top: 10px;">
    <form method="post" action="{% url 'editadrtemp' %}">
        {% csrf_token %}
        {% comment %} <textarea name="address" rows="3" cols="40">{{ user.address }}</textarea> {% endcomment %}
        {{ form.as_p }}
        <br/>
        <button type="submit" class="btn btn-success btn-sm">ذخیره</button>
        <button type="button" id="cancel-edit-address" class="btn btn-secondary btn-sm">لغو</button>
    </form>
</div>

<div class="cart-total-tag">
    <span>موجودی شما:</span>
    <span class="total-amount">{{ balance }} تومان</span>
</div>

{% for item in final %}
    <div class="cart-item">
        <div class="product-info">
            <h4 class="product-name">{{ item.product.name }}</h4>
            <p class="product-price">{{ item.product.price }} تومان</p>
            <p class="product-price">{{ item.time_create|date:"Y-m-d H:i" }}</p>
            <p class="product-price">{{ item.count }} تعداد : </p>
            {% if not item.status %}
                <p class="product-price">تحویل داده شده</p>
            {% else %}
                <p class="product-price">تحویل داده نشده</p>
            {% endif %}
        </div>
        <div class="product-count-form">
            
        </div>
    </div>
{% endfor %}


<div style="margin-top: 20px;">
    <button id="delete-account-btn" class="btn btn-danger">حذف حساب</button>
</div>


<div id="delete-account-modal" style="display:none; position: fixed; top: 50%; left: 50%; 
    transform: translate(-50%, -50%); background: white; border: 1px solid #ccc; padding: 20px; z-index: 1000;">
    <p>آیا مطمئن هستید که می‌خواهید حساب خود را حذف کنید؟</p>
    <form method="post" action="{% url 'deltemp' %}">
        {% csrf_token %}
        <button type="submit" class="btn btn-danger">بله</button>
        <button type="button" id="cancel-delete-account" class="btn btn-secondary">لغو</button>
    </form>
</div>
<a href="{% url "logouttemp" %}">خروج از حساب</a>
<div id="modal-overlay" style="display:none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
    background: rgba(0,0,0,0.5); z-index: 999;"></div>

<script>
    
    document.getElementById('edit-address-btn').addEventListener('click', function(){
        document.getElementById('edit-address-form').style.display = 'block';
        this.style.display = 'none';
    });

    
    document.getElementById('cancel-edit-address').addEventListener('click', function(){
        document.getElementById('edit-address-form').style.display = 'none';
        document.getElementById('edit-address-btn').style.display = 'inline-block';
    });

    
    document.getElementById('delete-account-btn').addEventListener('click', function(){
        document.getElementById('delete-account-modal').style.display = 'block';
        document.getElementById('modal-overlay').style.display = 'block';
    });

    
    document.getElementById('cancel-delete-account').addEventListener('click', function(){
        document.getElementById('delete-account-modal').style.display = 'none';
        document.getElementById('modal-overlay').style.display = 'none';
    });

    
    document.getElementById('modal-overlay').addEventListener('click', function(){
        this.style.display = 'none';
        document.getElementById('delete-account-modal').style.display = 'none';
    });
</script>

{% endblock body %}

